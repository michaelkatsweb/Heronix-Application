<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.heronix.ui.controller.CommunicationCenterController"
            prefWidth="1700" prefHeight="950">


    <!-- Top: Header -->
    <top>
        <VBox spacing="15" styleClass="header-gradient">
            <HBox spacing="15" alignment="CENTER_LEFT">
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="Communication Center"
                           styleClass="page-title-white"/>
                    <Label text="Send messages, announcements, and notifications to students, parents, and staff"
                           styleClass="text-white"/>
                </VBox>

                <!-- Quick Actions -->
                <VBox spacing="5" alignment="CENTER_RIGHT">
                    <Button text="âœ‰ Compose Message" onAction="#handleComposeMessage"
                            styleClass="button-primary"/>
                    <Button text="ðŸ“¢ New Announcement" onAction="#handleNewAnnouncement"
                            styleClass="button-primary"/>
                </VBox>
            </HBox>

            <!-- Stats Bar -->
            <HBox spacing="15">
                <VBox spacing="3" HBox.hgrow="ALWAYS"
                      styleClass="card-transparent">
                    <Label text="Unread Messages" styleClass="text-white"/>
                    <Label fx:id="unreadMessagesLabel" text="12"
                           styleClass="text-white"/>
                </VBox>

                <VBox spacing="3" HBox.hgrow="ALWAYS"
                      styleClass="card-transparent">
                    <Label text="Draft Messages" styleClass="text-white"/>
                    <Label fx:id="draftMessagesLabel" text="3"
                           styleClass="text-white"/>
                </VBox>

                <VBox spacing="3" HBox.hgrow="ALWAYS"
                      styleClass="card-transparent">
                    <Label text="Sent Today" styleClass="text-white"/>
                    <Label fx:id="sentTodayLabel" text="8"
                           styleClass="text-white"/>
                </VBox>

                <VBox spacing="3" HBox.hgrow="ALWAYS"
                      styleClass="card-transparent">
                    <Label text="Active Announcements" styleClass="text-white"/>
                    <Label fx:id="activeAnnouncementsLabel" text="5"
                           styleClass="text-white"/>
                </VBox>

                <VBox spacing="3" HBox.hgrow="ALWAYS"
                      styleClass="card-transparent">
                    <Label text="Pending Alerts" styleClass="text-white"/>
                    <Label fx:id="pendingAlertsLabel" text="2"
                           styleClass="text-white"/>
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- Center: Main Content -->
    <center>
        <SplitPane dividerPositions="0.25, 0.65" styleClass="main-container">

            <!-- Left: Navigation & Folders -->
            <VBox spacing="15" styleClass="padding-15-white">
                <Label text="Mailbox" styleClass="section-title"/>

                <!-- Folder List -->
                <VBox spacing="5" VBox.vgrow="ALWAYS">
                    <Button text="ðŸ“¥ Inbox (12)" onAction="#handleInbox"
                            styleClass="button-folder-active"
                            maxWidth="Infinity"/>
                    <Button text="ðŸ“¤ Sent" onAction="#handleSent"
                            styleClass="button-folder"
                            maxWidth="Infinity"/>
                    <Button text="ðŸ“ Drafts (3)" onAction="#handleDrafts"
                            styleClass="button-folder"
                            maxWidth="Infinity"/>
                    <Button text="â­ Starred" onAction="#handleStarred"
                            styleClass="button-folder"
                            maxWidth="Infinity"/>
                    <Button text="ðŸ—‘ Trash" onAction="#handleTrash"
                            styleClass="button-folder"
                            maxWidth="Infinity"/>

                    <Separator/>

                    <Label text="Categories" styleClass="label-12-bold"/>

                    <Button text="ðŸ‘¥ From Parents" onAction="#handleFromParents"
                            styleClass="button-category"
                            maxWidth="Infinity"/>
                    <Button text="ðŸ‘¨â€ðŸ« From Teachers" onAction="#handleFromTeachers"
                            styleClass="button-category"
                            maxWidth="Infinity"/>
                    <Button text="ðŸ‘¨â€ðŸ’¼ From Staff" onAction="#handleFromStaff"
                            styleClass="button-category"
                            maxWidth="Infinity"/>
                    <Button text="ðŸŽ“ From Students" onAction="#handleFromStudents"
                            styleClass="button-category"
                            maxWidth="Infinity"/>
                </VBox>

                <!-- Quick Stats -->
                <VBox spacing="8" styleClass="card">
                    <Label text="Quick Stats" styleClass="label-11-bold"/>
                    <Label fx:id="totalMessagesLabel" text="Total: 342 messages" styleClass="label-10"/>
                    <Label fx:id="storageUsedLabel" text="Storage: 125 MB / 5 GB" styleClass="label-10"/>
                </VBox>
            </VBox>

            <!-- Center: Message List -->
            <VBox spacing="10" styleClass="padding-15-white">
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label fx:id="folderTitleLabel" text="Inbox" styleClass="section-title"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <TextField fx:id="messageSearchField" promptText="Search messages..." prefWidth="250"/>
                    <Button text="ðŸ”" onAction="#handleSearch"
                            styleClass="button-icon"/>
                </HBox>

                <!-- Toolbar -->
                <HBox spacing="10" alignment="CENTER_LEFT" styleClass="card">
                    <CheckBox fx:id="selectAllCheckBox" text="Select All"/>
                    <Separator orientation="VERTICAL"/>
                    <Button text="Delete" onAction="#handleDeleteMessages"
                            styleClass="button-toolbar"/>
                    <Button text="Mark Read" onAction="#handleMarkRead"
                            styleClass="button-toolbar"/>
                    <Button text="Star" onAction="#handleStarMessages"
                            styleClass="button-toolbar"/>
                    <Region HBox.hgrow="ALWAYS"/>
                    <ComboBox fx:id="sortComboBox" prefWidth="150">
                        <items>
                            <String fx:value="Sort: Newest First"/>
                            <String fx:value="Sort: Oldest First"/>
                            <String fx:value="Sort: Sender A-Z"/>
                            <String fx:value="Sort: Unread First"/>
                        </items>
                    </ComboBox>
                </HBox>

                <!-- Message List -->
                <ListView fx:id="messageListView" VBox.vgrow="ALWAYS">
                    <placeholder>
                        <Label text="No messages" styleClass="text-muted"/>
                    </placeholder>
                </ListView>

                <!-- Pagination -->
                <HBox spacing="10" alignment="CENTER">
                    <Label fx:id="paginationLabel" text="1-20 of 342"/>
                    <Button text="â—€ Previous" onAction="#handlePreviousPage"
                            styleClass="button-toolbar"/>
                    <Button text="Next â–¶" onAction="#handleNextPage"
                            styleClass="button-toolbar"/>
                </HBox>
            </VBox>

            <!-- Right: Message Preview / Compose -->
            <VBox spacing="10" styleClass="padding-15-white">
                <!-- Tabs for Preview/Compose/Announcements -->
                <TabPane fx:id="rightPanelTabPane" VBox.vgrow="ALWAYS">
                    <!-- Message Preview Tab -->
                    <Tab text="Message Preview" closable="false">
                        <VBox spacing="10" styleClass="content-padding-10">
                            <!-- Message Header -->
                            <VBox spacing="8" styleClass="card">
                                <Label fx:id="previewSubjectLabel" text="Select a message to preview"
                                       styleClass="section-title"/>
                                <HBox spacing="10">
                                    <Label text="From:" style="-fx-font-weight: bold; -fx-min-width: 50;"/>
                                    <Label fx:id="previewFromLabel" text="â€”"/>
                                </HBox>
                                <HBox spacing="10">
                                    <Label text="To:" style="-fx-font-weight: bold; -fx-min-width: 50;"/>
                                    <Label fx:id="previewToLabel" text="â€”"/>
                                </HBox>
                                <HBox spacing="10">
                                    <Label text="Date:" style="-fx-font-weight: bold; -fx-min-width: 50;"/>
                                    <Label fx:id="previewDateLabel" text="â€”"/>
                                </HBox>
                            </VBox>

                            <!-- Message Body -->
                            <TextArea fx:id="previewBodyArea" editable="false" wrapText="true" VBox.vgrow="ALWAYS"
                                      promptText="Message content will appear here..."/>

                            <!-- Action Buttons -->
                            <HBox spacing="10">
                                <Button text="Reply" onAction="#handleReply"
                                        styleClass="button-primary"/>
                                <Button text="Reply All" onAction="#handleReplyAll"
                                        styleClass="button-primary"/>
                                <Button text="Forward" onAction="#handleForward"
                                        styleClass="button-primary"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="ðŸ—‘ Delete" onAction="#handleDeleteCurrent"
                                        styleClass="button-action"/>
                            </HBox>
                        </VBox>
                    </Tab>

                    <!-- Compose Tab -->
                    <Tab text="Compose" closable="false">
                        <VBox spacing="10" styleClass="content-padding-10">
                            <Label text="New Message" styleClass="section-title"/>

                            <GridPane hgap="10" vgap="10">
                                <columnConstraints>
                                    <ColumnConstraints minWidth="60" prefWidth="60"/>
                                    <ColumnConstraints hgrow="ALWAYS"/>
                                </columnConstraints>

                                <Label text="To:" GridPane.columnIndex="0" GridPane.rowIndex="0"
                                       styleClass="form-label"/>
                                <HBox spacing="10" GridPane.columnIndex="1" GridPane.rowIndex="0">
                                    <ComboBox fx:id="recipientTypeComboBox" prefWidth="150">
                                        <items>
                                            <String fx:value="Individual"/>
                                            <String fx:value="Group"/>
                                            <String fx:value="Class"/>
                                            <String fx:value="Grade Level"/>
                                            <String fx:value="All Parents"/>
                                            <String fx:value="All Staff"/>
                                        </items>
                                    </ComboBox>
                                    <TextField fx:id="recipientField" promptText="Enter recipients..." HBox.hgrow="ALWAYS"/>
                                </HBox>

                                <Label text="Subject:" GridPane.columnIndex="0" GridPane.rowIndex="1"
                                       styleClass="form-label"/>
                                <TextField fx:id="subjectField" GridPane.columnIndex="1" GridPane.rowIndex="1"
                                           promptText="Message subject..."/>
                            </GridPane>

                            <Label text="Message:" styleClass="form-label"/>
                            <TextArea fx:id="composeBodyArea" wrapText="true" VBox.vgrow="ALWAYS"
                                      promptText="Type your message here..."/>

                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <CheckBox fx:id="highPriorityCheckBox" text="High Priority"/>
                                <CheckBox fx:id="requestReadReceiptCheckBox" text="Request Read Receipt"/>
                                <CheckBox fx:id="sendCopyToMeCheckBox" text="Send Copy to Me"/>
                            </HBox>

                            <HBox spacing="10">
                                <Button text="ðŸ“Ž Attach File" onAction="#handleAttachFile"
                                        style="-fx-padding: 8 15; -fx-cursor: hand;"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="ðŸ’¾ Save Draft" onAction="#handleSaveDraft"
                                        styleClass="button-primary"/>
                                <Button text="âœ‰ Send Message" onAction="#handleSendMessage"
                                        styleClass="button-primary"/>
                            </HBox>
                        </VBox>
                    </Tab>

                    <!-- Announcements Tab -->
                    <Tab text="Announcements" closable="false">
                        <VBox spacing="10" styleClass="content-padding-10">
                            <HBox spacing="10" alignment="CENTER_LEFT">
                                <Label text="School Announcements" styleClass="section-title"/>
                                <Region HBox.hgrow="ALWAYS"/>
                                <Button text="+ Create Announcement" onAction="#handleCreateAnnouncement"
                                        styleClass="button-primary"/>
                            </HBox>

                            <ListView fx:id="announcementsListView" VBox.vgrow="ALWAYS">
                                <placeholder>
                                    <Label text="No announcements" styleClass="text-muted"/>
                                </placeholder>
                            </ListView>
                        </VBox>
                    </Tab>

                    <!-- Templates Tab -->
                    <Tab text="Templates" closable="false">
                        <VBox spacing="10" styleClass="content-padding-10">
                            <Label text="Message Templates" styleClass="section-title"/>

                            <ListView fx:id="templatesListView" VBox.vgrow="ALWAYS">
                                <placeholder>
                                    <Label text="No templates" styleClass="text-muted"/>
                                </placeholder>
                            </ListView>

                            <Button text="Use Template" onAction="#handleUseTemplate"
                                    styleClass="button-primary"
                                    maxWidth="Infinity"/>
                        </VBox>
                    </Tab>
                </TabPane>
            </VBox>

        </SplitPane>
    </center>

    <!-- Bottom: Status Bar -->
    <bottom>
        <HBox spacing="15" alignment="CENTER_LEFT"
              styleClass="card">
            <Label fx:id="statusLabel" text="Ready" styleClass="label-11"/>
            <Separator orientation="VERTICAL"/>
            <Label fx:id="lastUpdatedLabel" text="Last updated: Just now" styleClass="text-muted"/>

            <Region HBox.hgrow="ALWAYS"/>

            <Button text="ðŸ”„ Refresh" onAction="#handleRefresh"
                    styleClass="button-action"/>
            <Button text="âš™ Settings" onAction="#handleSettings"
                    styleClass="button-action"/>
        </HBox>
    </bottom>

</BorderPane>
