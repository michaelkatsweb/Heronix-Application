<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<!--
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
    IMPORT WIZARD - COMPLETE & ENHANCED
    Location: src/main/resources/fxml/ImportWizard.fxml
    
    ‚úÖ FEATURES:
    - Modern 3-step wizard interface
    - File selection with preview
    - Entity type selection with combo box
    - Lenient/Strict mode toggle with descriptions
    - Real-time progress tracking
    - Detailed results display
    
    ‚úÖ IMPROVEMENTS:
    - Better spacing and layout
    - Enhanced visual feedback
    - Clear step indicators
    - Informative tooltips
    - Professional styling
    
    @version 3.0.0 - Enhanced with Lenient Import
    @since 2025-10-17
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
-->

<BorderPane xmlns="http://javafx.com/javafx/21"
    xmlns:fx="http://javafx.com/fxml/1"
    fx:controller="com.heronix.ui.controller.ImportWizardController"
    prefWidth="1100" prefHeight="850"
    minWidth="1000" minHeight="750"
    styleClass="root main-container">


    <!-- ================================================================== -->
    <!-- HEADER -->
    <!-- ================================================================== -->

    <top>
        <VBox spacing="15"
            styleClass="wizard-header">

            <!-- Title -->
            <Label text="üì• Import Data Wizard"
                styleClass="dialog-title-28-slate" />

            <Label text="Import teachers, students, courses, and rooms from Excel or CSV files"
                styleClass="text-muted" />

            <!-- Step Indicator -->
            <HBox spacing="15" alignment="CENTER_LEFT" style="-fx-padding: 10 0 0 0;">
                <Label fx:id="step1Indicator" text="1Ô∏è‚É£ Select File"
                    styleClass="step-indicator-active" />
                <Label text="‚Üí" styleClass="text-muted" />
                <Label fx:id="step2Indicator" text="2Ô∏è‚É£ Configure Import"
                    styleClass="text-muted" />
                <Label text="‚Üí" styleClass="text-muted" />
                <Label fx:id="step3Indicator" text="3Ô∏è‚É£ Import &amp; Review"
                    styleClass="text-muted" />
            </HBox>

            <Separator />
        </VBox>
    </top>

    <!-- ================================================================== -->
    <!-- MAIN CONTENT AREA -->
    <!-- ================================================================== -->

    <center>
        <StackPane>
            <padding>
                <Insets top="30" right="30" bottom="30" left="30" />
            </padding>

            <!-- ============================================================ -->
            <!-- STEP 1: FILE SELECTION -->
            <!-- ============================================================ -->

            <VBox fx:id="step1Box" spacing="25" alignment="TOP_CENTER" maxWidth="700" visible="true">

                <VBox spacing="15" alignment="CENTER"
                    styleClass="wizard-card">

                    <Label text="Select File to Import"
                        styleClass="section-title" />

                    <VBox spacing="8" alignment="CENTER_LEFT"
                        styleClass="card">
                        <Label text="üìã Supported file formats:"
                            style="-fx-font-weight: bold; -fx-font-size: 13;" />
                        <Label text="  ‚Ä¢ Excel files (.xlsx, .xls)"
                            styleClass="text-muted, text-small-12" />
                        <Label text="  ‚Ä¢ CSV files (.csv)"
                            styleClass="text-muted, text-small-12" />
                        <Label text="  ‚Ä¢ Up to 10,000 records per file"
                            styleClass="text-muted, text-small-12" />
                    </VBox>

                    <HBox spacing="10" alignment="CENTER" style="-fx-padding: 10 0 0 0;">
                        <TextField fx:id="filePathField"
                            promptText="No file selected..."
                            prefWidth="450" editable="false"
                            styleClass="card" />
                        <Button text="üìÅ Browse..." onAction="#handleBrowse"
                            styleClass="button-primary">
                            <tooltip>
                                <Tooltip text="Select an Excel or CSV file to import" />
                            </tooltip>
                        </Button>
                    </HBox>

                    <!-- File Info Display -->
                    <VBox fx:id="fileInfoBox" spacing="8" alignment="CENTER" visible="false"
                        styleClass="card">
                        <Label text="‚úÖ File Selected"
                            styleClass="text-muted" />
                        <Label fx:id="fileNameLabel"
                            styleClass="text-muted" />
                        <Label fx:id="fileSizeLabel"
                            styleClass="text-muted" />
                        <Label fx:id="fileTypeLabel"
                            styleClass="text-muted" />
                    </VBox>
                </VBox>

                <Region VBox.vgrow="ALWAYS" />
            </VBox>

            <!-- ============================================================ -->
            <!-- STEP 2: ENTITY TYPE & MODE SELECTION -->
            <!-- ============================================================ -->

            <VBox fx:id="step2Box" spacing="25" alignment="TOP_CENTER" maxWidth="700"
                visible="false">

                <VBox spacing="20" alignment="CENTER"
                    styleClass="wizard-card">

                    <Label text="Configure Import Settings"
                        styleClass="section-title" />

                    <!-- Entity Type Selection -->
                    <VBox spacing="10" alignment="CENTER_LEFT" style="-fx-padding: 10;">
                        <Label text="What type of data are you importing?"
                            styleClass="header-14-slate" />

                        <ComboBox fx:id="entityTypeComboBox"
                            promptText="Select entity type..."
                            prefWidth="500"
                            style="-fx-font-size: 13; -fx-padding: 8;">
                            <tooltip>
                                <Tooltip
                                    text="Choose the type of data in your file: Teachers, Students, Courses, or Rooms" />
                            </tooltip>
                        </ComboBox>
                    </VBox>

                    <Separator prefWidth="650" />

                    <!-- Import Mode Selection -->
                    <VBox spacing="12" alignment="CENTER_LEFT" style="-fx-padding: 10;">
                        <Label text="Import Mode"
                            styleClass="header-14-slate" />

                        <HBox spacing="15" alignment="CENTER_LEFT">
                            <CheckBox fx:id="lenientModeCheckBox"
                                text="üîß Lenient Mode (Recommended)"
                                selected="true"
                                style="-fx-font-size: 13; -fx-font-weight: bold;">
                                <tooltip>
                                    <Tooltip wrapText="true" maxWidth="350">
                                        <text>
                                            LENIENT MODE (Recommended):
                                            ‚úÖ Auto-generates missing data with smart defaults
                                            ‚úÖ Never fails or crashes
                                            ‚úÖ Flags incomplete records for review
                                            ‚úÖ You can complete missing data later in Data Review
                                            STRICT MODE:
                                            ‚ùå Rejects records with missing data
                                            ‚ùå Import may fail if data is incomplete
                                            ‚úÖ Ensures high data quality from import
                                        </text>
                                    </Tooltip>
                                </tooltip>
                            </CheckBox>
                        </HBox>

                        <Label fx:id="modeDescriptionLabel" wrapText="true" maxWidth="600"
                            styleClass="text-muted" />
                    </VBox>

                    <Separator prefWidth="650" />

                    <!-- Additional Info -->
                    <VBox spacing="8" alignment="CENTER_LEFT"
                        styleClass="card">
                        <Label text="üí° Import Tips:"
                            styleClass="header-13-warning" />
                        <Label text="  ‚Ä¢ First row should contain column headers"
                            styleClass="text-muted" />
                        <Label text="  ‚Ä¢ Remove any merged cells before importing"
                            styleClass="text-muted" />
                        <Label text="  ‚Ä¢ Date format: YYYY-MM-DD (e.g., 2025-01-15)"
                            styleClass="text-muted" />
                        <Label text="  ‚Ä¢ Phone format: (555) 123-4567 or 555-123-4567"
                            styleClass="text-muted" />
                    </VBox>
                </VBox>

                <Region VBox.vgrow="ALWAYS" />
            </VBox>

            <!-- ============================================================ -->
            <!-- STEP 3: IMPORT PROGRESS & RESULTS -->
            <!-- ============================================================ -->

            <VBox fx:id="step3Box" spacing="25" alignment="TOP_CENTER" maxWidth="750"
                visible="false">

                <VBox spacing="20" alignment="CENTER"
                    styleClass="wizard-card">

                    <Label text="Import Progress"
                        styleClass="section-title" />

                    <!-- Progress Bar -->
                    <VBox spacing="10" alignment="CENTER" style="-fx-padding: 20;">
                        <ProgressBar fx:id="progressBar"
                            prefWidth="650"
                            prefHeight="25"
                            styleClass="progress-bar-accent-green" />
                        <Label fx:id="progressLabel"
                            text="Preparing import..."
                            styleClass="text-muted" />
                    </VBox>

                    <Separator prefWidth="700" />

                    <!-- Results Display -->
                    <VBox spacing="10" alignment="CENTER">
                        <Label text="Import Results"
                            styleClass="header-16-slate" />

                        <ScrollPane fitToWidth="true" prefHeight="350"
                            styleClass="scroll-pane-bordered">
                            <TextArea fx:id="resultTextArea"
                                wrapText="true"
                                editable="false"
                                styleClass="text-area-console">
                            </TextArea>
                        </ScrollPane>
                    </VBox>

                    <!-- Action Buttons (After Import) -->
                    <HBox spacing="15" alignment="CENTER" style="-fx-padding: 10 0 0 0;">
                        <Button text="üìã View Data Review" onAction="#handleViewDataReview"
                            styleClass="button-primary">
                            <tooltip>
                                <Tooltip
                                    text="Open Data Review screen to complete missing information" />
                            </tooltip>
                        </Button>
                    </HBox>
                </VBox>

                <Region VBox.vgrow="ALWAYS" />
            </VBox>

        </StackPane>
    </center>

    <!-- ================================================================== -->
    <!-- FOOTER - NAVIGATION BUTTONS -->
    <!-- ================================================================== -->

    <bottom>
        <HBox spacing="15" alignment="CENTER"
            styleClass="wizard-footer">

            <!-- Back Button -->
            <Button fx:id="backButton" text="‚¨ÖÔ∏è Back" onAction="#handleBack"
                styleClass="button-primary" />

            <Region HBox.hgrow="ALWAYS" />

            <!-- Cancel Button -->
            <Button fx:id="cancelButton" text="‚ùå Cancel" onAction="#handleCancel"
                styleClass="button-primary">
                <tooltip>
                    <Tooltip text="Cancel and close the import wizard" />
                </tooltip>
            </Button>

            <!-- Next Button -->
            <Button fx:id="nextButton" text="Next ‚û°Ô∏è" onAction="#handleNext"
                disable="true"
                styleClass="button-primary">
                <tooltip>
                    <Tooltip text="Continue to next step" />
                </tooltip>
            </Button>

            <!-- Import Button -->
            <Button fx:id="importButton" text="üöÄ Start Import" onAction="#handleImport"
                visible="false"
                styleClass="button-primary">
                <tooltip>
                    <Tooltip text="Begin importing data from the selected file" />
                </tooltip>
            </Button>

            <!-- Finish Button -->
            <Button fx:id="finishButton" text="‚úÖ Finish" onAction="#handleFinish"
                visible="false" disable="true"
                styleClass="button-primary">
                <tooltip>
                    <Tooltip text="Complete the import and close the wizard" />
                </tooltip>
            </Button>
        </HBox>
    </bottom>

</BorderPane>