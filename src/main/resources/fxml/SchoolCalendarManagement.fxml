<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.heronix.ui.controller.SchoolCalendarManagementController"
            prefWidth="1700" prefHeight="950">


    <!-- Top: Header -->
    <top>
        <VBox spacing="15" styleClass="header-gradient">
            <HBox spacing="15" alignment="CENTER_LEFT">
                <VBox spacing="5" HBox.hgrow="ALWAYS">
                    <Label text="School Calendar Management"
                           styleClass="page-title-white"/>
                    <Label text="Manage academic calendar, events, holidays, and school-wide scheduling"
                           styleClass="text-white"/>
                </VBox>

                <!-- Quick Actions -->
                <VBox spacing="5" alignment="CENTER_RIGHT">
                    <Button text="+ New Event" onAction="#handleNewEvent"
                            styleClass="button-primary"/>
                    <Button text="ðŸ“¤ Export Calendar" onAction="#handleExportCalendar"
                            styleClass="button-primary"/>
                </VBox>
            </HBox>

            <!-- Calendar Navigation & Stats -->
            <HBox spacing="15" alignment="CENTER_LEFT">
                <Button text="â—€ Prev" onAction="#handlePreviousMonth"
                        styleClass="card-transparent"/>
                <Label fx:id="currentMonthLabel" text="December 2024"
                       styleClass="text-white"/>
                <Button text="Next â–¶" onAction="#handleNextMonth"
                        styleClass="card-transparent"/>
                <Button text="Today" onAction="#handleToday"
                        styleClass="card-transparent"/>

                <Region HBox.hgrow="ALWAYS"/>

                <VBox spacing="3" styleClass="card-transparent">
                    <Label text="Events This Month" styleClass="text-white"/>
                    <Label fx:id="eventsThisMonthLabel" text="24"
                           styleClass="text-white"/>
                </VBox>

                <VBox spacing="3" styleClass="card-transparent">
                    <Label text="School Days" styleClass="text-white"/>
                    <Label fx:id="schoolDaysLabel" text="18"
                           styleClass="text-white"/>
                </VBox>

                <VBox spacing="3" styleClass="card-transparent">
                    <Label text="Holidays" styleClass="text-white"/>
                    <Label fx:id="holidaysLabel" text="5"
                           styleClass="text-white"/>
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- Center: Main Content -->
    <center>
        <SplitPane dividerPositions="0.7" styleClass="main-container">

            <!-- Calendar View -->
            <VBox spacing="15" styleClass="panel-white-padded">
                <!-- View Selector -->
                <HBox spacing="10" alignment="CENTER_LEFT">
                    <Label text="View:" styleClass="form-label"/>
                    <ToggleButton fx:id="monthViewButton" text="Month" selected="true"/>
                    <ToggleButton fx:id="weekViewButton" text="Week"/>
                    <ToggleButton fx:id="dayViewButton" text="Day"/>
                    <ToggleButton fx:id="agendaViewButton" text="Agenda"/>

                    <Region HBox.hgrow="ALWAYS"/>

                    <Label text="Filter:" styleClass="form-label"/>
                    <ComboBox fx:id="eventFilterComboBox" prefWidth="150">
                        <items>
                            <String fx:value="All Events"/>
                            <String fx:value="Academic"/>
                            <String fx:value="Holidays"/>
                            <String fx:value="Sports"/>
                            <String fx:value="Activities"/>
                            <String fx:value="Testing"/>
                            <String fx:value="Parent Events"/>
                        </items>
                    </ComboBox>
                </HBox>

                <!-- Calendar Grid -->
                <VBox spacing="0" VBox.vgrow="ALWAYS" styleClass="border-light">
                    <!-- Day Headers -->
                    <GridPane fx:id="calendarHeaderGrid" styleClass="main-container">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                        </columnConstraints>
                        <Label text="Sunday" GridPane.columnIndex="0"
                               styleClass="calendar-day-header"
                               maxWidth="Infinity"/>
                        <Label text="Monday" GridPane.columnIndex="1"
                               styleClass="calendar-day-header"
                               maxWidth="Infinity"/>
                        <Label text="Tuesday" GridPane.columnIndex="2"
                               styleClass="calendar-day-header"
                               maxWidth="Infinity"/>
                        <Label text="Wednesday" GridPane.columnIndex="3"
                               styleClass="calendar-day-header"
                               maxWidth="Infinity"/>
                        <Label text="Thursday" GridPane.columnIndex="4"
                               styleClass="calendar-day-header"
                               maxWidth="Infinity"/>
                        <Label text="Friday" GridPane.columnIndex="5"
                               styleClass="calendar-day-header"
                               maxWidth="Infinity"/>
                        <Label text="Saturday" GridPane.columnIndex="6"
                               styleClass="calendar-day-header-last"
                               maxWidth="Infinity"/>
                    </GridPane>

                    <!-- Calendar Days Grid -->
                    <GridPane fx:id="calendarDaysGrid" VBox.vgrow="ALWAYS">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                            <ColumnConstraints percentWidth="14.28"/>
                        </columnConstraints>
                        <rowConstraints>
                            <RowConstraints percentHeight="16.66"/>
                            <RowConstraints percentHeight="16.66"/>
                            <RowConstraints percentHeight="16.66"/>
                            <RowConstraints percentHeight="16.66"/>
                            <RowConstraints percentHeight="16.66"/>
                            <RowConstraints percentHeight="16.66"/>
                        </rowConstraints>
                    </GridPane>
                </VBox>

                <!-- Legend -->
                <HBox spacing="15" alignment="CENTER_LEFT" styleClass="card">
                    <Label text="Legend:" styleClass="form-label"/>
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="â—" styleClass="text-muted"/>
                        <Label text="Academic"/>
                    </HBox>
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="â—" styleClass="text-muted"/>
                        <Label text="Holiday"/>
                    </HBox>
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="â—" styleClass="text-muted"/>
                        <Label text="Sports"/>
                    </HBox>
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="â—" styleClass="text-muted"/>
                        <Label text="Activities"/>
                    </HBox>
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="â—" styleClass="text-muted"/>
                        <Label text="Testing"/>
                    </HBox>
                    <HBox spacing="5" alignment="CENTER">
                        <Label text="â—" styleClass="text-muted"/>
                        <Label text="Parent Events"/>
                    </HBox>
                </HBox>
            </VBox>

            <!-- Right Panel: Event Details & List -->
            <VBox spacing="15" styleClass="panel-white-padded">
                <Label text="Event Details" styleClass="section-title"/>

                <!-- Selected Date Info -->
                <VBox spacing="8" styleClass="card, metric-info">
                    <Label fx:id="selectedDateLabel" text="No date selected"
                           styleClass="label-14-bold-blue"/>
                    <Label fx:id="selectedDateEventsLabel" text="Click a date to view events"
                           styleClass="text-muted"/>
                </VBox>

                <!-- Events List for Selected Date -->
                <VBox spacing="10" VBox.vgrow="ALWAYS">
                    <HBox spacing="10" alignment="CENTER_LEFT">
                        <Label text="Events" styleClass="form-label"/>
                        <Region HBox.hgrow="ALWAYS"/>
                        <Button text="+ Add Event" onAction="#handleAddEventToDate"
                                styleClass="button-add-small"/>
                    </HBox>

                    <ListView fx:id="dateEventsListView" VBox.vgrow="ALWAYS">
                        <placeholder>
                            <Label text="No events on selected date" styleClass="text-muted"/>
                        </placeholder>
                    </ListView>
                </VBox>

                <!-- Quick Add Event -->
                <VBox spacing="10" styleClass="card">
                    <Label text="Quick Add Event" styleClass="label-12-bold"/>

                    <TextField fx:id="quickEventTitleField" promptText="Event title..."/>

                    <HBox spacing="10">
                        <DatePicker fx:id="quickEventDatePicker" promptText="Select date" HBox.hgrow="ALWAYS"/>
                        <ComboBox fx:id="quickEventCategoryComboBox" promptText="Category" prefWidth="120">
                            <items>
                                <String fx:value="Academic"/>
                                <String fx:value="Holiday"/>
                                <String fx:value="Sports"/>
                                <String fx:value="Activities"/>
                                <String fx:value="Testing"/>
                                <String fx:value="Parent Events"/>
                            </items>
                        </ComboBox>
                    </HBox>

                    <Button text="Add Event" onAction="#handleQuickAddEvent"
                            styleClass="button-primary"
                            maxWidth="Infinity"/>
                </VBox>

                <!-- Academic Year Settings -->
                <VBox spacing="10" styleClass="card, metric-warning">
                    <Label text="Academic Year Settings" styleClass="label-12-bold-orange"/>

                    <GridPane hgap="10" vgap="8">
                        <Label text="School Year:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                        <ComboBox fx:id="academicYearComboBox" GridPane.columnIndex="1" GridPane.rowIndex="0" prefWidth="150">
                            <items>
                                <String fx:value="2024-2025"/>
                                <String fx:value="2023-2024"/>
                                <String fx:value="2025-2026"/>
                            </items>
                        </ComboBox>

                        <Label text="Total Days:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                        <Label fx:id="totalSchoolDaysLabel" text="180 days" GridPane.columnIndex="1" GridPane.rowIndex="1"
                               styleClass="form-label"/>

                        <Label text="Days Elapsed:" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                        <Label fx:id="daysElapsedLabel" text="75 days" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                    </GridPane>

                    <Button text="Manage Academic Calendar" onAction="#handleManageAcademicCalendar"
                            styleClass="button-primary"
                            maxWidth="Infinity"/>
                </VBox>
            </VBox>

        </SplitPane>
    </center>

    <!-- Bottom: Status Bar -->
    <bottom>
        <HBox spacing="15" alignment="CENTER_LEFT"
              styleClass="card">
            <Label fx:id="statusLabel" text="Calendar loaded" styleClass="status-label-11"/>
            <Separator orientation="VERTICAL"/>
            <Label fx:id="lastUpdatedLabel" text="Last updated: Just now" styleClass="text-muted"/>

            <Region HBox.hgrow="ALWAYS"/>

            <Button text="ðŸ“… Import Calendar" onAction="#handleImportCalendar"
                    styleClass="button-footer-6-15"/>
            <Button text="ðŸ–¨ Print Calendar" onAction="#handlePrintCalendar"
                    styleClass="button-footer-6-15"/>
            <Button text="âš™ Settings" onAction="#handleSettings"
                    styleClass="button-footer-6-15"/>
        </HBox>
    </bottom>

</BorderPane>
