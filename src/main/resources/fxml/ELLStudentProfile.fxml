<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.collections.FXCollections?>
<?import java.lang.String?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.heronix.ui.controller.ELLStudentProfileController"
            prefWidth="1400" prefHeight="950"
            styleClass="main-container">


    <!-- Top: Header -->
    <top>
        <VBox spacing="10" styleClass="header-white-border">
            <Label text="ELL Student Profile" styleClass="header-blue-large"/>
            <Label text="Comprehensive English Language Learner identification, program placement, and service delivery documentation"
                   styleClass="text-subtitle-666" wrapText="true"/>

            <!-- Federal Compliance Banner -->
            <HBox spacing="10" styleClass="card, metric-info">
                <Label text="ðŸ“‹" styleClass="icon-16"/>
                <VBox spacing="5">
                    <Label text="Title III &amp; ESSA Compliance"
                           styleClass="text-blue-dark"/>
                    <Label text="Complete Home Language Survey, annual proficiency assessments, and parent notifications are federally mandated."
                           styleClass="text-muted" wrapText="true"/>
                </VBox>
            </HBox>
        </VBox>
    </top>

    <!-- Center: Main Form -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="scroll-pane-transparent">
            <VBox spacing="20" styleClass="content-padding-20">

                <!-- Student Selection -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Student Information" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                        </columnConstraints>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Student *" styleClass="form-label"/>
                            <ComboBox fx:id="studentComboBox" prefWidth="Infinity" promptText="Select student"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Grade" styleClass="form-label"/>
                            <TextField fx:id="gradeField" editable="false" promptText="Auto-filled"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Student ID" styleClass="form-label"/>
                            <TextField fx:id="studentIdField" editable="false" promptText="Auto-filled"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <Label text="Date of Birth" styleClass="form-label"/>
                            <TextField fx:id="dateOfBirthField" editable="false" promptText="Auto-filled"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label text="Identification Date *" styleClass="form-label"/>
                            <DatePicker fx:id="identificationDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label text="ELL Status *" styleClass="form-label"/>
                            <ComboBox fx:id="ellStatusComboBox" prefWidth="Infinity">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="ACTIVE"/>
                                        <String fx:value="RECLASSIFIED"/>
                                        <String fx:value="MONITORED_YEAR_1"/>
                                        <String fx:value="MONITORED_YEAR_2"/>
                                        <String fx:value="MONITORED_YEAR_3"/>
                                        <String fx:value="MONITORED_YEAR_4"/>
                                        <String fx:value="EXITED"/>
                                        <String fx:value="INACTIVE"/>
                                    </FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Home Language Survey (Yellow Highlighted - Required) -->
                <VBox spacing="15" styleClass="form-section, card">
                    <Label text="ðŸ“‹ Home Language Survey (Required by Federal Law)" styleClass="section-header, section-title-warning"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="50"/>
                            <ColumnConstraints percentWidth="50"/>
                        </columnConstraints>

                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0" GridPane.columnSpan="2">
                            <CheckBox fx:id="homeLanguageSurveyCompletedCheckBox" text="Home Language Survey Completed"
                                      styleClass="form-label"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label text="Survey Completion Date" styleClass="form-label"/>
                            <DatePicker fx:id="homeLanguageSurveyDatePicker" prefWidth="Infinity"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Language Information -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Language Information" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                        </columnConstraints>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Native Language *" styleClass="form-label"/>
                            <TextField fx:id="nativeLanguageField" promptText="e.g., Spanish, Mandarin"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Home Language" styleClass="form-label"/>
                            <TextField fx:id="homeLanguageField" promptText="Language spoken at home"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Parent/Guardian Language" styleClass="form-label"/>
                            <TextField fx:id="parentLanguageField" promptText="Primary language of parent"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <Label text="Country of Origin" styleClass="form-label"/>
                            <TextField fx:id="countryOfOriginField" promptText="e.g., Mexico, China"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2">
                            <Label text="Other Languages Spoken" styleClass="form-label"/>
                            <TextField fx:id="otherLanguagesField" promptText="Comma-separated list"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <Label text="US Schools Enrollment Date" styleClass="form-label"/>
                            <DatePicker fx:id="enrollmentInUSSchoolsDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="3" GridPane.rowIndex="1">
                            <Label text="Years in US Schools" styleClass="form-label"/>
                            <TextField fx:id="yearsInUSSchoolsField" promptText="Auto-calculated" editable="false"/>
                        </VBox>

                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="2">
                            <CheckBox fx:id="immigrantStatusCheckBox" text="Recent Immigrant (last 3 years)"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Proficiency Level -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="English Proficiency Level" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                            <ColumnConstraints percentWidth="25"/>
                        </columnConstraints>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Overall Proficiency Level *" styleClass="form-label"/>
                            <ComboBox fx:id="proficiencyLevelComboBox" prefWidth="Infinity">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="ENTERING"/>
                                        <String fx:value="EMERGING"/>
                                        <String fx:value="DEVELOPING"/>
                                        <String fx:value="EXPANDING"/>
                                        <String fx:value="BRIDGING"/>
                                        <String fx:value="REACHING"/>
                                    </FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Last Assessment Date" styleClass="form-label"/>
                            <DatePicker fx:id="lastProficiencyAssessmentDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label text="Listening Level (1-6)" styleClass="form-label"/>
                            <TextField fx:id="listeningLevelField" promptText="1-6"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label text="Speaking Level (1-6)" styleClass="form-label"/>
                            <TextField fx:id="speakingLevelField" promptText="1-6"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="1">
                            <Label text="Reading Level (1-6)" styleClass="form-label"/>
                            <TextField fx:id="readingLevelField" promptText="1-6"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="3" GridPane.rowIndex="1">
                            <Label text="Writing Level (1-6)" styleClass="form-label"/>
                            <TextField fx:id="writingLevelField" promptText="1-6"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="2">
                            <Label text="Comprehension Level (1-6)" styleClass="form-label"/>
                            <TextField fx:id="comprehensionLevelField" promptText="1-6"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="2">
                            <Label text="Average Score" styleClass="form-label"/>
                            <TextField fx:id="averageScoreField" editable="false" promptText="Auto-calculated"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Program Placement -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Program Placement" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="34"/>
                        </columnConstraints>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Program Type *" styleClass="form-label"/>
                            <ComboBox fx:id="programTypeComboBox" prefWidth="Infinity">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="ESL_PULL_OUT"/>
                                        <String fx:value="ESL_PUSH_IN"/>
                                        <String fx:value="SHELTERED_ENGLISH"/>
                                        <String fx:value="DUAL_LANGUAGE"/>
                                        <String fx:value="TRANSITIONAL_BILINGUAL"/>
                                        <String fx:value="STRUCTURED_ENGLISH_IMMERSION"/>
                                        <String fx:value="NEWCOMER"/>
                                        <String fx:value="CONTENT_BASED_ESL"/>
                                        <String fx:value="OTHER"/>
                                    </FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Program Entry Date" styleClass="form-label"/>
                            <DatePicker fx:id="programEntryDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Program Exit Date" styleClass="form-label"/>
                            <DatePicker fx:id="programExitDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <Label text="Years in Program" styleClass="form-label"/>
                            <TextField fx:id="yearsInProgramField" editable="false" promptText="Auto-calculated"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Service Delivery -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Service Delivery" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="34"/>
                        </columnConstraints>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Service Delivery Model" styleClass="form-label"/>
                            <ComboBox fx:id="serviceDeliveryModelComboBox" prefWidth="Infinity">
                                <items>
                                    <FXCollections fx:factory="observableArrayList">
                                        <String fx:value="PULL_OUT"/>
                                        <String fx:value="PUSH_IN"/>
                                        <String fx:value="SMALL_GROUP"/>
                                        <String fx:value="ONE_ON_ONE"/>
                                        <String fx:value="RESOURCE_ROOM"/>
                                        <String fx:value="INCLUSION"/>
                                        <String fx:value="SELF_CONTAINED"/>
                                        <String fx:value="HYBRID"/>
                                    </FXCollections>
                                </items>
                            </ComboBox>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Service Provider" styleClass="form-label"/>
                            <ComboBox fx:id="serviceProviderComboBox" prefWidth="Infinity" promptText="Select ESL teacher"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Service Minutes Per Week" styleClass="form-label"/>
                            <TextField fx:id="serviceMinutesField" promptText="e.g., 180"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2">
                            <Label text="Service Frequency" styleClass="form-label"/>
                            <TextField fx:id="serviceFrequencyField" promptText="e.g., 5 days per week, 36 minutes daily"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Progress Monitoring -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Progress Monitoring" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="34"/>
                        </columnConstraints>

                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <CheckBox fx:id="annualAssessmentRequiredCheckBox" text="Annual Assessment Required"
                                      selected="true" styleClass="form-label"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Next Annual Assessment Date" styleClass="form-label"/>
                            <DatePicker fx:id="nextAnnualAssessmentDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Last Progress Monitoring Date" styleClass="form-label"/>
                            <DatePicker fx:id="lastProgressMonitoringDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="2">
                            <Label text="Progress Monitoring Frequency" styleClass="form-label"/>
                            <TextField fx:id="progressMonitoringFrequencyField" promptText="e.g., Quarterly, Monthly"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Reclassification -->
                <VBox spacing="15" styleClass="form-section, card, metric-success">
                    <Label text="Reclassification &amp; Monitoring" styleClass="section-header, section-title-success"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="34"/>
                        </columnConstraints>

                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <CheckBox fx:id="eligibleForReclassificationCheckBox" text="Eligible for Reclassification"
                                      styleClass="form-label"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Eligibility Date" styleClass="form-label"/>
                            <DatePicker fx:id="reclassificationEligibilityDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Reclassification Date" styleClass="form-label"/>
                            <DatePicker fx:id="reclassificationDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="1" GridPane.columnSpan="3">
                            <Label text="Reclassification Reason" styleClass="form-label"/>
                            <TextArea fx:id="reclassificationReasonArea" prefRowCount="2" wrapText="true"
                                      promptText="Document criteria met for reclassification"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="2">
                            <Label text="Monitoring Period Start Date" styleClass="form-label"/>
                            <DatePicker fx:id="monitoringPeriodStartDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="2">
                            <Label text="Monitoring Period (Years)" styleClass="form-label"/>
                            <TextField fx:id="monitoringPeriodYearsField" promptText="Typically 4 years"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Parent Communication (Yellow Highlighted - Required) -->
                <VBox spacing="15" styleClass="form-section, card">
                    <Label text="âš  Parent/Guardian Communication (Required by Law)" styleClass="section-header, section-title-warning"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="33"/>
                            <ColumnConstraints percentWidth="34"/>
                        </columnConstraints>

                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <CheckBox fx:id="parentNotificationSentCheckBox" text="Parent Notification Sent"
                                      styleClass="form-label"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Notification Date" styleClass="form-label"/>
                            <DatePicker fx:id="parentNotificationDatePicker" prefWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Notification Language" styleClass="form-label"/>
                            <TextField fx:id="parentNotificationLanguageField" promptText="Language of notification"/>
                        </VBox>

                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="1">
                            <CheckBox fx:id="translationServicesRequiredCheckBox" text="Translation Services Required"/>
                            <CheckBox fx:id="interpreterRequiredCheckBox" text="Interpreter Required"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="1">
                            <Label text="Interpreter Language" styleClass="form-label"/>
                            <TextField fx:id="interpreterLanguageField" promptText="Language needed"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Title III Funding -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Title III Funding" styleClass="section-header, section-title-dark"/>

                    <GridPane hgap="15" vgap="15">
                        <VBox spacing="8" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <CheckBox fx:id="titleIIIEligibleCheckBox" text="Title III Eligible"
                                      selected="true" styleClass="form-label"/>
                            <CheckBox fx:id="titleIIIFundedCheckBox" text="Title III Funded"/>
                        </VBox>
                    </GridPane>
                </VBox>

                <!-- Additional Notes -->
                <VBox spacing="15" styleClass="form-section, form-section-white">
                    <Label text="Additional Notes" styleClass="section-header, section-title-dark"/>

                    <TextArea fx:id="notesArea" prefRowCount="4" wrapText="true"
                              promptText="Document any additional information, special circumstances, or observations"/>
                </VBox>

            </VBox>
        </ScrollPane>
    </center>

    <!-- Bottom: Button Bar -->
    <bottom>
        <HBox spacing="10" styleClass="footer-white-border-top" alignment="CENTER_RIGHT">
            <Button text="Save Profile" onAction="#handleSave"
                    styleClass="button-primary"/>
            <Button text="Clear Form" onAction="#handleClear"
                    styleClass="button-primary"/>
            <Button text="Close" onAction="#handleClose"
                    styleClass="button-primary"/>
        </HBox>
    </bottom>

</BorderPane>
