<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.heronix.ui.controller.StudentRegistrationEnrollmentController"
            prefWidth="1400" prefHeight="900">


    <!-- Top: Header -->
    <top>
        <VBox spacing="15" styleClass="card">
            <Label text="Student Registration &amp; Enrollment"
                   styleClass="page-title-white"/>
            <Label text="Complete student registration with automatic course enrollment and document management"
                   styleClass="text-white"/>
        </VBox>
    </top>

    <!-- Center: Registration Wizard -->
    <center>
        <BorderPane styleClass="main-container">

            <!-- Progress Indicator -->
            <top>
                <VBox spacing="15" styleClass="progress-header-white">
                    <Label text="Registration Progress" styleClass="label-14-bold"/>
                    <HBox spacing="0" alignment="CENTER">
                        <VBox spacing="5" alignment="CENTER" styleClass="step-container-padding" HBox.hgrow="ALWAYS">
                            <Label fx:id="step1Indicator" text="●" styleClass="text-muted"/>
                            <Label text="Student Info" styleClass="label-11"/>
                        </VBox>
                        <Separator orientation="HORIZONTAL" HBox.hgrow="ALWAYS"/>
                        <VBox spacing="5" alignment="CENTER" styleClass="step-container-padding" HBox.hgrow="ALWAYS">
                            <Label fx:id="step2Indicator" text="○" styleClass="text-muted"/>
                            <Label text="Guardian Info" styleClass="label-11"/>
                        </VBox>
                        <Separator orientation="HORIZONTAL" HBox.hgrow="ALWAYS"/>
                        <VBox spacing="5" alignment="CENTER" styleClass="step-container-padding" HBox.hgrow="ALWAYS">
                            <Label fx:id="step3Indicator" text="○" styleClass="text-muted"/>
                            <Label text="Enrollment" styleClass="label-11"/>
                        </VBox>
                        <Separator orientation="HORIZONTAL" HBox.hgrow="ALWAYS"/>
                        <VBox spacing="5" alignment="CENTER" styleClass="step-container-padding" HBox.hgrow="ALWAYS">
                            <Label fx:id="step4Indicator" text="○" styleClass="text-muted"/>
                            <Label text="Documents" styleClass="label-11"/>
                        </VBox>
                        <Separator orientation="HORIZONTAL" HBox.hgrow="ALWAYS"/>
                        <VBox spacing="5" alignment="CENTER" styleClass="step-container-padding" HBox.hgrow="ALWAYS">
                            <Label fx:id="step5Indicator" text="○" styleClass="text-muted"/>
                            <Label text="Review" styleClass="label-11"/>
                        </VBox>
                    </HBox>
                    <ProgressBar fx:id="registrationProgressBar" progress="0.2" prefWidth="Infinity"/>
                </VBox>
            </top>

            <center>
                <ScrollPane fitToWidth="true" fitToHeight="true">
                    <VBox fx:id="wizardContainer" spacing="20" style="-fx-padding: 30;">

                        <!-- Step 1: Student Information -->
                        <VBox fx:id="step1Panel" spacing="20" styleClass="step-panel-blue">
                            <Label text="Step 1: Student Information" styleClass="step-title-blue"/>

                            <GridPane hgap="20" vgap="15">
                                <columnConstraints>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                    <ColumnConstraints percentWidth="25"/>
                                </columnConstraints>

                                <Label text="First Name:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                <TextField fx:id="firstNameField" promptText="First name" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                <Label text="Middle Name:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                                <TextField fx:id="middleNameField" promptText="Middle name" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                                <Label text="Last Name:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                <TextField fx:id="lastNameField" promptText="Last name" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                <Label text="Preferred Name:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
                                <TextField fx:id="preferredNameField" promptText="Nickname" GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                                <Label text="Date of Birth:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                <DatePicker fx:id="birthDatePicker" promptText="MM/DD/YYYY" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                                <Label text="Gender:*" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="2"/>
                                <ComboBox fx:id="genderComboBox" promptText="Select gender..." maxWidth="Infinity" GridPane.columnIndex="3" GridPane.rowIndex="2"/>

                                <Label text="Student ID:" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                <TextField fx:id="studentIdField" promptText="Auto-generated" disable="true" GridPane.columnIndex="1" GridPane.rowIndex="3"/>

                                <Label text="Grade Level:*" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="3"/>
                                <ComboBox fx:id="gradeLevelComboBox" promptText="Select grade..." maxWidth="Infinity" GridPane.columnIndex="3" GridPane.rowIndex="3"/>

                                <Label text="Ethnicity:" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="4"/>
                                <ComboBox fx:id="ethnicityComboBox" promptText="Select..." maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="4"/>

                                <Label text="Language:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="4"/>
                                <ComboBox fx:id="languageComboBox" promptText="Primary language" maxWidth="Infinity" GridPane.columnIndex="3" GridPane.rowIndex="4"/>

                                <Label text="Home Address:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="5"/>
                                <TextField fx:id="addressField" promptText="Street address" GridPane.columnIndex="1" GridPane.rowIndex="5" GridPane.columnSpan="3"/>

                                <Label text="City:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="6"/>
                                <TextField fx:id="cityField" promptText="City" GridPane.columnIndex="1" GridPane.rowIndex="6"/>

                                <Label text="State:*" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="6"/>
                                <ComboBox fx:id="stateComboBox" promptText="State" maxWidth="Infinity" GridPane.columnIndex="3" GridPane.rowIndex="6"/>

                                <Label text="ZIP Code:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="7"/>
                                <TextField fx:id="zipCodeField" promptText="ZIP" GridPane.columnIndex="1" GridPane.rowIndex="7"/>

                                <Label text="Phone:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="7"/>
                                <TextField fx:id="phoneField" promptText="(555) 555-5555" GridPane.columnIndex="3" GridPane.rowIndex="7"/>
                            </GridPane>
                        </VBox>

                        <!-- Step 2: Guardian Information -->
                        <VBox fx:id="step2Panel" spacing="20" managed="false" visible="false" styleClass="step-panel-blue">
                            <Label text="Step 2: Guardian/Parent Information" styleClass="step-title-blue"/>

                            <!-- Guardian 1 -->
                            <VBox spacing="15" styleClass="card, metric-info">
                                <Label text="Primary Guardian" styleClass="label-14-bold-blue-dark"/>

                                <GridPane hgap="20" vgap="15">
                                    <columnConstraints>
                                        <ColumnConstraints percentWidth="25"/>
                                        <ColumnConstraints percentWidth="25"/>
                                        <ColumnConstraints percentWidth="25"/>
                                        <ColumnConstraints percentWidth="25"/>
                                    </columnConstraints>

                                    <Label text="First Name:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <TextField fx:id="guardian1FirstNameField" promptText="First name" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                    <Label text="Last Name:*" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                                    <TextField fx:id="guardian1LastNameField" promptText="Last name" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                                    <Label text="Relationship:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                    <ComboBox fx:id="guardian1RelationshipComboBox" promptText="Select..." maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                    <Label text="Email:*" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
                                    <TextField fx:id="guardian1EmailField" promptText="email@example.com" GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                                    <Label text="Cell Phone:*" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                    <TextField fx:id="guardian1CellPhoneField" promptText="(555) 555-5555" GridPane.columnIndex="1" GridPane.rowIndex="2"/>

                                    <Label text="Work Phone:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="2"/>
                                    <TextField fx:id="guardian1WorkPhoneField" promptText="(555) 555-5555" GridPane.columnIndex="3" GridPane.rowIndex="2"/>

                                    <Label text="Employer:" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="3"/>
                                    <TextField fx:id="guardian1EmployerField" promptText="Company name" GridPane.columnIndex="1" GridPane.rowIndex="3" GridPane.columnSpan="3"/>
                                </GridPane>

                                <CheckBox fx:id="guardian1CanPickupCheckBox" text="Authorized for pickup" selected="true"/>
                                <CheckBox fx:id="guardian1EmergencyContactCheckBox" text="Emergency contact" selected="true"/>
                            </VBox>

                            <!-- Guardian 2 (Optional) -->
                            <VBox spacing="15" styleClass="card">
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <Label text="Secondary Guardian (Optional)" styleClass="label-14-bold-gray"/>
                                    <CheckBox fx:id="addGuardian2CheckBox" text="Add second guardian" onAction="#handleAddGuardian2"/>
                                </HBox>

                                <GridPane fx:id="guardian2Grid" hgap="20" vgap="15" managed="false" visible="false">
                                    <columnConstraints>
                                        <ColumnConstraints percentWidth="25"/>
                                        <ColumnConstraints percentWidth="25"/>
                                        <ColumnConstraints percentWidth="25"/>
                                        <ColumnConstraints percentWidth="25"/>
                                    </columnConstraints>

                                    <Label text="First Name:" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
                                    <TextField fx:id="guardian2FirstNameField" promptText="First name" GridPane.columnIndex="1" GridPane.rowIndex="0"/>

                                    <Label text="Last Name:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
                                    <TextField fx:id="guardian2LastNameField" promptText="Last name" GridPane.columnIndex="3" GridPane.rowIndex="0"/>

                                    <Label text="Relationship:" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
                                    <ComboBox fx:id="guardian2RelationshipComboBox" promptText="Select..." maxWidth="Infinity" GridPane.columnIndex="1" GridPane.rowIndex="1"/>

                                    <Label text="Email:" styleClass="form-label" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
                                    <TextField fx:id="guardian2EmailField" promptText="email@example.com" GridPane.columnIndex="3" GridPane.rowIndex="1"/>

                                    <Label text="Cell Phone:" styleClass="form-label" GridPane.columnIndex="0" GridPane.rowIndex="2"/>
                                    <TextField fx:id="guardian2CellPhoneField" promptText="(555) 555-5555" GridPane.columnIndex="1" GridPane.rowIndex="2"/>
                                </GridPane>
                            </VBox>
                        </VBox>

                        <!-- Step 3: Course Enrollment -->
                        <VBox fx:id="step3Panel" spacing="20" managed="false" visible="false" styleClass="step-panel-blue">
                            <Label text="Step 3: Course Enrollment" styleClass="step-title-blue"/>

                            <HBox spacing="20">
                                <!-- Available Courses -->
                                <VBox spacing="10" HBox.hgrow="ALWAYS">
                                    <Label text="Available Courses" styleClass="label-14-bold"/>
                                    <TextField fx:id="courseSearchField" promptText="Search courses..."/>
                                    <TableView fx:id="availableCoursesTable" VBox.vgrow="ALWAYS" prefHeight="400">
                                        <columns>
                                            <TableColumn fx:id="courseCodeColumn" text="Code" prefWidth="80"/>
                                            <TableColumn fx:id="courseNameColumn" text="Course Name" prefWidth="200"/>
                                            <TableColumn fx:id="creditsColumn" text="Credits" prefWidth="60"/>
                                            <TableColumn fx:id="availableSeatsColumn" text="Seats" prefWidth="60"/>
                                        </columns>
                                    </TableView>
                                    <Button text="Add to Schedule →" onAction="#handleAddCourse" styleClass="button-primary"/>
                                </VBox>

                                <!-- Enrolled Courses -->
                                <VBox spacing="10" HBox.hgrow="ALWAYS">
                                    <Label text="Enrolled Courses" styleClass="label-14-bold"/>
                                    <Label fx:id="totalCreditsLabel" text="Total Credits: 0" styleClass="text-muted"/>
                                    <ListView fx:id="enrolledCoursesList" VBox.vgrow="ALWAYS" prefHeight="400"/>
                                    <Button text="← Remove Course" onAction="#handleRemoveCourse" styleClass="header-danger"/>
                                </VBox>
                            </HBox>
                        </VBox>

                        <!-- Step 4: Documents -->
                        <VBox fx:id="step4Panel" spacing="20" managed="false" visible="false" styleClass="step-panel-blue">
                            <Label text="Step 4: Required Documents" styleClass="step-title-blue"/>

                            <!-- Required Documents Section -->
                            <VBox spacing="10">
                                <Label text="Required Documents:" styleClass="label-14-bold"/>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <CheckBox fx:id="birthCertificateCheckBox" text="Birth Certificate" prefWidth="200"/>
                                    <ComboBox fx:id="birthCertificateStatus" promptText="Status" prefWidth="140"/>
                                </HBox>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <CheckBox fx:id="immunizationCheckBox" text="Immunization Records" prefWidth="200"/>
                                    <ComboBox fx:id="immunizationStatus" promptText="Status" prefWidth="140"/>
                                </HBox>
                                <HBox spacing="10" alignment="CENTER_LEFT">
                                    <CheckBox fx:id="proofOfResidenceCheckBox" text="Proof of Residence" prefWidth="200"/>
                                    <ComboBox fx:id="proofOfResidenceStatus" promptText="Status" prefWidth="140"/>
                                </HBox>
                            </VBox>

                            <Separator/>

                            <!-- Student Photo Section -->
                            <VBox spacing="10">
                                <Label text="Student Photo:" styleClass="label-14-bold"/>
                                <HBox spacing="15" alignment="CENTER_LEFT">
                                    <RadioButton fx:id="photoTakenRadio" text="Photo Taken"/>
                                    <RadioButton fx:id="photoNotAvailableRadio" text="Photo Not Available (follow-up needed)"/>
                                    <RadioButton fx:id="photoRefusedRadio" text="Parent Refused Photo"/>
                                </HBox>
                                <VBox fx:id="photoRefusalReasonBox" spacing="5" managed="false" visible="false">
                                    <Label text="Refusal Reason/Documentation:" styleClass="label-12"/>
                                    <TextArea fx:id="photoRefusalReasonArea" promptText="Document the reason for photo refusal..." prefRowCount="2"/>
                                </VBox>
                            </VBox>

                            <Separator/>

                            <!-- Optional Documents Section -->
                            <VBox spacing="10">
                                <Label text="Optional Documents:" styleClass="label-14-bold"/>
                                <CheckBox fx:id="previousTranscriptCheckBox" text="Previous School Transcript"/>
                                <CheckBox fx:id="iepDocumentCheckBox" text="IEP/504 Plan (if applicable)"/>
                                <CheckBox fx:id="medicalRecordsCheckBox" text="Medical Records"/>
                                <CheckBox fx:id="photoReleaseCheckBox" text="Photo/Media Release Form"/>
                            </VBox>

                            <Separator/>

                            <!-- Missing Documents Note -->
                            <VBox fx:id="missingDocumentsBox" spacing="10" styleClass="card, metric-warning">
                                <Label text="Missing Documents?" styleClass="form-label"/>
                                <Label text="If parent hasn't brought all required documents, you can save this registration as 'Incomplete' and follow up later." wrapText="true" styleClass="label-12"/>
                                <HBox spacing="10">
                                    <DatePicker fx:id="expectedDocumentsDate" promptText="Expected submission date"/>
                                    <TextField fx:id="documentNotesField" promptText="Notes for follow-up..." HBox.hgrow="ALWAYS"/>
                                </HBox>
                            </VBox>

                            <HBox spacing="15">
                                <Button text="Upload Documents" onAction="#handleUploadDocuments" styleClass="button-primary"/>
                                <Button fx:id="saveIncompleteBtn" text="Save as Incomplete" onAction="#handleSaveIncomplete" styleClass="button-primary"/>
                            </HBox>
                        </VBox>

                        <!-- Step 5: Review & Submit -->
                        <VBox fx:id="step5Panel" spacing="20" managed="false" visible="false" styleClass="step-panel-blue">
                            <Label text="Step 5: Review &amp; Submit" styleClass="step-title-blue"/>

                            <TextArea fx:id="reviewSummaryArea" editable="false" wrapText="true" prefHeight="400"/>

                            <CheckBox fx:id="certifyCheckBox" text="I certify that all information provided is accurate and complete" styleClass="form-label"/>
                        </VBox>

                    </VBox>
                </ScrollPane>
            </center>

        </BorderPane>
    </center>

    <!-- Bottom: Navigation -->
    <bottom>
        <HBox spacing="15" alignment="CENTER_RIGHT" styleClass="footer-white-border">
            <Button fx:id="previousButton" text="← Previous" onAction="#handlePrevious" disable="true"
                    styleClass="button-primary"/>

            <Region HBox.hgrow="ALWAYS"/>

            <Button fx:id="nextButton" text="Next →" onAction="#handleNext"
                    styleClass="button-primary"/>

            <Button fx:id="submitButton" text="Submit Registration" onAction="#handleSubmit" managed="false" visible="false"
                    styleClass="button-primary"/>
        </HBox>
    </bottom>

</BorderPane>
