<?xml version="1.0" encoding="UTF-8"?>

<?import java.lang.String?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Text?>

<BorderPane xmlns="http://javafx.com/javafx"
            xmlns:fx="http://javafx.com/fxml"
            fx:controller="com.heronix.ui.controller.GiftedDashboardController"
            prefWidth="1600" prefHeight="1000">


    <!-- Top: Header -->
    <top>
        <VBox spacing="15" styleClass="card">
            <Label text="Gifted &amp; Talented Program Dashboard"
                   styleClass="page-title-white"/>
            <Label text="Monitor identification, program placements, talent development, and academic enrichment"
                   styleClass="text-white"/>
        </VBox>
    </top>

    <!-- Center: Main Content -->
    <center>
        <ScrollPane fitToWidth="true" styleClass="main-container">
            <VBox spacing="25" styleClass="content-padding-25">

                <!-- Summary Statistics Cards -->
                <HBox spacing="20">
                    <VBox spacing="10" styleClass="stat-card, stat-card-base">
                        <Label text="Total Gifted Students" styleClass="stat-card-label"/>
                        <Label fx:id="totalGiftedLabel" text="0" styleClass="stat-value-purple"/>
                    </VBox>

                    <VBox spacing="10" styleClass="stat-card, stat-card-base">
                        <Label text="Active in Services" styleClass="stat-card-label"/>
                        <Label fx:id="activeServicesLabel" text="0" styleClass="stat-value-green"/>
                    </VBox>

                    <VBox spacing="10" styleClass="stat-card, stat-card-base">
                        <Label text="Referred/Screening" styleClass="stat-card-label"/>
                        <Label fx:id="screeningLabel" text="0" styleClass="stat-value-orange"/>
                    </VBox>

                    <VBox spacing="10" styleClass="stat-card, stat-card-base">
                        <Label text="Annual Reviews Due" styleClass="stat-card-label"/>
                        <Label fx:id="reviewsDueLabel" text="0" styleClass="stat-value-red"/>
                    </VBox>

                    <VBox spacing="10" styleClass="stat-card, stat-card-base">
                        <Label text="Advanced Courses" styleClass="stat-card-label"/>
                        <Label fx:id="advancedCoursesLabel" text="0" styleClass="stat-value-blue"/>
                    </VBox>

                    <VBox spacing="10" styleClass="stat-card, stat-card-base">
                        <Label text="Multi-Talented" styleClass="stat-card-label"/>
                        <Label fx:id="multiTalentedLabel" text="0" styleClass="stat-value-deep-purple"/>
                    </VBox>
                </HBox>

                <!-- Charts Row -->
                <HBox spacing="20">
                    <!-- Gifted Areas Distribution -->
                    <VBox spacing="15" styleClass="section-container" HBox.hgrow="ALWAYS">
                        <Label text="Gifted Areas Distribution" styleClass="section-title"/>
                        <PieChart fx:id="giftedAreasChart" legendVisible="true" prefHeight="300"/>
                    </VBox>

                    <!-- Program Type Distribution -->
                    <VBox spacing="15" styleClass="section-container" HBox.hgrow="ALWAYS">
                        <Label text="Program Type Distribution" styleClass="section-title"/>
                        <PieChart fx:id="programTypeChart" legendVisible="true" prefHeight="300"/>
                    </VBox>

                    <!-- Status Distribution -->
                    <VBox spacing="15" styleClass="section-container" HBox.hgrow="ALWAYS">
                        <Label text="Status Distribution" styleClass="section-title"/>
                        <BarChart fx:id="statusChart" prefHeight="300">
                            <xAxis>
                                <CategoryAxis label="Status"/>
                            </xAxis>
                            <yAxis>
                                <NumberAxis label="Count"/>
                            </yAxis>
                        </BarChart>
                    </VBox>
                </HBox>

                <!-- Alerts & Action Items -->
                <HBox spacing="20">
                    <!-- Annual Reviews Due -->
                    <VBox spacing="15" styleClass="card" HBox.hgrow="ALWAYS">
                        <Label text="⚠ Annual Reviews Due" styleClass="alert-title-warning"/>
                        <ListView fx:id="annualReviewsDueListView" prefHeight="200"/>
                    </VBox>

                    <!-- Parent Consent Needed -->
                    <VBox spacing="15" styleClass="card, metric-danger" HBox.hgrow="ALWAYS">
                        <Label text="⚠ Parent Consent Needed" styleClass="alert-title-danger"/>
                        <ListView fx:id="parentConsentNeededListView" prefHeight="200"/>
                    </VBox>

                    <!-- Underperforming Students -->
                    <VBox spacing="15" styleClass="card" HBox.hgrow="ALWAYS">
                        <Label text="⚠ Underperforming Students" styleClass="alert-title-pink"/>
                        <ListView fx:id="underperformingListView" prefHeight="200"/>
                    </VBox>

                    <!-- Progress Reviews Overdue -->
                    <VBox spacing="15" styleClass="card, metric-warning" HBox.hgrow="ALWAYS">
                        <Label text="⚠ Progress Reviews Overdue" styleClass="alert-title-orange"/>
                        <ListView fx:id="progressReviewsOverdueListView" prefHeight="200"/>
                    </VBox>
                </HBox>

                <!-- Filters Section -->
                <VBox spacing="15" styleClass="section-container">
                    <Label text="Filter Students" styleClass="section-title"/>

                    <GridPane hgap="15" vgap="15">
                        <columnConstraints>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                            <ColumnConstraints percentWidth="20"/>
                        </columnConstraints>

                        <VBox spacing="5" GridPane.columnIndex="0" GridPane.rowIndex="0">
                            <Label text="Status:" styleClass="form-label"/>
                            <ComboBox fx:id="statusFilterComboBox" promptText="All Statuses" maxWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="1" GridPane.rowIndex="0">
                            <Label text="Gifted Area:" styleClass="form-label"/>
                            <ComboBox fx:id="giftedAreaFilterComboBox" promptText="All Areas" maxWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="2" GridPane.rowIndex="0">
                            <Label text="Program Type:" styleClass="form-label"/>
                            <ComboBox fx:id="programTypeFilterComboBox" promptText="All Programs" maxWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="3" GridPane.rowIndex="0">
                            <Label text="Grade Level:" styleClass="form-label"/>
                            <ComboBox fx:id="gradeFilterComboBox" promptText="All Grades" maxWidth="Infinity"/>
                        </VBox>

                        <VBox spacing="5" GridPane.columnIndex="4" GridPane.rowIndex="0">
                            <Label text="Search:" styleClass="form-label"/>
                            <TextField fx:id="searchField" promptText="Student name or ID..."/>
                        </VBox>

                        <HBox spacing="10" GridPane.columnIndex="0" GridPane.columnSpan="5" GridPane.rowIndex="1">
                            <Button text="Apply Filters" onAction="#handleApplyFilters"
                                    styleClass="button-primary"/>
                            <Button text="Clear Filters" onAction="#handleClearFilters"
                                    styleClass="button-primary"/>
                        </HBox>
                    </GridPane>
                </VBox>

                <!-- Students Table -->
                <VBox spacing="15" styleClass="section-container">
                    <Label text="Gifted Students" styleClass="section-title"/>

                    <TableView fx:id="studentsTableView" VBox.vgrow="ALWAYS" prefHeight="400">
                        <columns>
                            <TableColumn fx:id="studentIdColumn" text="Student ID" prefWidth="100"/>
                            <TableColumn fx:id="lastNameColumn" text="Last Name" prefWidth="120"/>
                            <TableColumn fx:id="firstNameColumn" text="First Name" prefWidth="120"/>
                            <TableColumn fx:id="gradeColumn" text="Grade" prefWidth="70"/>
                            <TableColumn fx:id="statusColumn" text="Status" prefWidth="150"/>
                            <TableColumn fx:id="primaryAreaColumn" text="Primary Area" prefWidth="150"/>
                            <TableColumn fx:id="programTypeColumn" text="Program Type" prefWidth="150"/>
                            <TableColumn fx:id="gpaColumn" text="GPA" prefWidth="70"/>
                            <TableColumn fx:id="advancedCoursesColumn" text="Advanced Courses" prefWidth="120"/>
                            <TableColumn fx:id="reviewStatusColumn" text="Review Status" prefWidth="120"/>
                            <TableColumn fx:id="actionsColumn" text="Actions" prefWidth="150"/>
                        </columns>
                    </TableView>
                </VBox>

            </VBox>
        </ScrollPane>
    </center>

    <!-- Bottom: Action Buttons -->
    <bottom>
        <HBox spacing="15" alignment="CENTER_RIGHT" styleClass="footer-bar">
            <Button text="Add Gifted Student" onAction="#handleAddGiftedStudent"
                    styleClass="button-primary"/>
            <Button text="Export Report" onAction="#handleExportReport"
                    styleClass="button-primary"/>
            <Button text="Refresh" onAction="#handleRefresh"
                    styleClass="button-primary"/>
        </HBox>
    </bottom>

</BorderPane>
