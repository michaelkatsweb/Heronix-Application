<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<!--
    Grade Progression Dialog
    Location: src/main/resources/fxml/GradeProgression.fxml

    Confirmation dialog for progressing to next academic year.
    Shows preview of what will happen and allows user to confirm.
-->
<VBox xmlns="http://javafx.com/javafx/21"
    xmlns:fx="http://javafx.com/fxml/1"
    fx:controller="com.heronix.ui.controller.GradeProgressionController"
    spacing="20"
    prefWidth="700"
    prefHeight="650"
    styleClass="main-container, root">

    <padding>
        <Insets top="20" right="20" bottom="20" left="20" />
    </padding>

    <!-- Header -->
    <HBox alignment="CENTER_LEFT" spacing="15"
        styleClass="form-panel">
        <Label text="⏭️ Progress to Next Academic Year"
            styleClass="header-20-warning" />
    </HBox>

    <!-- Warning Banner -->
    <VBox spacing="10" styleClass="card">
        <Label text="⚠️ WARNING: This is a major operation!" styleClass="header-16-warning" />
        <Label text="This will:" styleClass="form-label" wrapText="true" />
        <VBox spacing="5" style="-fx-padding: 0 0 0 20;">
            <Label text="• Archive all current student enrollments" styleClass="text-muted" />
            <Label text="• Graduate all 12th grade students" styleClass="text-muted" />
            <Label text="• Promote students: 11→12, 10→11, 9→10" styleClass="text-muted" />
            <Label text="• Clear all course enrollments (ready for new assignments)" styleClass="text-muted" />
            <Label text="• Create a new academic year" styleClass="text-muted" />
        </VBox>
    </VBox>

    <!-- Current Year Info -->
    <VBox spacing="10" styleClass="form-panel">
        <Label text="Current Academic Year" styleClass="header-16-dark" />
        <Separator />
        <GridPane hgap="15" vgap="10">
            <columnConstraints>
                <ColumnConstraints percentWidth="30" />
                <ColumnConstraints percentWidth="70" />
            </columnConstraints>

            <Label text="Year:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="form-label" />
            <Label fx:id="currentYearLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="0" styleClass="form-label" />

            <Label text="Dates:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="form-label" />
            <Label fx:id="currentDatesLabel" text="-" GridPane.columnIndex="1" GridPane.rowIndex="1" />
        </GridPane>
    </VBox>

    <!-- Preview Statistics -->
    <VBox spacing="10" styleClass="form-panel">
        <Label text="Impact Preview" styleClass="header-16-dark" />
        <Separator />

        <GridPane hgap="20" vgap="10">
            <columnConstraints>
                <ColumnConstraints percentWidth="50" />
                <ColumnConstraints percentWidth="50" />
            </columnConstraints>

            <!-- Row 1 -->
            <VBox GridPane.columnIndex="0" GridPane.rowIndex="0" spacing="5" styleClass="card">
                <Label text="12th Graders (Will Graduate)" styleClass="form-label" />
                <Label fx:id="grade12CountLabel" text="0" styleClass="stat-value-28-pink-material" />
            </VBox>

            <VBox GridPane.columnIndex="1" GridPane.rowIndex="0" spacing="5" styleClass="card, metric-warning">
                <Label text="11th Graders (→ 12th)" styleClass="form-label" />
                <Label fx:id="grade11CountLabel" text="0" styleClass="stat-value-28-orange-material" />
            </VBox>

            <!-- Row 2 -->
            <VBox GridPane.columnIndex="0" GridPane.rowIndex="1" spacing="5" styleClass="card, metric-success">
                <Label text="10th Graders (→ 11th)" styleClass="form-label" />
                <Label fx:id="grade10CountLabel" text="0" styleClass="stat-value-28-green-material" />
            </VBox>

            <VBox GridPane.columnIndex="1" GridPane.rowIndex="1" spacing="5" styleClass="card, metric-info">
                <Label text="9th Graders (→ 10th)" styleClass="form-label" />
                <Label fx:id="grade9CountLabel" text="0" styleClass="stat-value-28-blue-material" />
            </VBox>
        </GridPane>

        <HBox spacing="10" alignment="CENTER" style="-fx-padding: 10 0 0 0;">
            <Label text="Total Enrollments to Archive:" style="-fx-font-weight: bold; -fx-font-size: 14;" />
            <Label fx:id="totalEnrollmentsLabel" text="0" styleClass="stat-value-18-orange" />
        </HBox>
    </VBox>

    <!-- New Year Configuration -->
    <VBox spacing="10" styleClass="form-panel">
        <Label text="New Academic Year Configuration" styleClass="header-16-dark" />
        <Separator />

        <GridPane hgap="15" vgap="15">
            <columnConstraints>
                <ColumnConstraints percentWidth="30" />
                <ColumnConstraints percentWidth="70" />
            </columnConstraints>

            <!-- Row 1 -->
            <Label text="Year Name:" GridPane.columnIndex="0" GridPane.rowIndex="0" styleClass="form-label" />
            <TextField fx:id="newYearNameField" promptText="e.g., 2025-2026" GridPane.columnIndex="1" GridPane.rowIndex="0" />

            <!-- Row 2 -->
            <Label text="Start Date:" GridPane.columnIndex="0" GridPane.rowIndex="1" styleClass="form-label" />
            <DatePicker fx:id="newStartDatePicker" GridPane.columnIndex="1" GridPane.rowIndex="1" prefWidth="200" />

            <!-- Row 3 -->
            <Label text="End Date:" GridPane.columnIndex="0" GridPane.rowIndex="2" styleClass="form-label" />
            <DatePicker fx:id="newEndDatePicker" GridPane.columnIndex="1" GridPane.rowIndex="2" prefWidth="200" />

            <!-- Row 4 -->
            <Label text="Graduation Date:" GridPane.columnIndex="0" GridPane.rowIndex="3" styleClass="form-label" />
            <DatePicker fx:id="newGraduationDatePicker" GridPane.columnIndex="1" GridPane.rowIndex="3" prefWidth="200" />
        </GridPane>
    </VBox>

    <!-- Progress Indicator -->
    <VBox fx:id="progressBox" spacing="10" styleClass="form-panel" visible="false" managed="false">
        <Label text="Progression in Progress..." styleClass="header-16-warning-progress" />
        <ProgressBar fx:id="progressBar" prefWidth="Infinity" />
        <Label fx:id="progressLabel" text="Initializing..." styleClass="text-muted" wrapText="true" />
    </VBox>

    <!-- Buttons -->
    <HBox spacing="15" alignment="CENTER">
        <Button text="Cancel" onAction="#handleCancel"
            styleClass="button-secondary"
            fx:id="cancelButton" />

        <Button text="⏭️ START PROGRESSION" onAction="#handleStartProgression"
            styleClass="button-warning"
            fx:id="startButton">
            <font>
                <Font name="System Bold" size="14" />
            </font>
        </Button>
    </HBox>

</VBox>
